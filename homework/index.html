<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아날로그 반도체 부족현상</title>
    <!-- 사용할 js 모듈들 -->
    <script src="./js/jquery-3.6.0.min.js"></script>
    
    <!-- 트리 -->
    <script src="./node_modules/jstree/src/jstree.js"></script>
    <script src="./node_modules/jstree/src/jstree.checkbox.js"></script>

    <!-- 차트 -->
    <script src="./node_modules/highcharts/highcharts.js"></script>
    <script src="./node_modules/highcharts/modules/series-label.js"></script>
    <script src="./node_modules/highcharts/modules/exporting.js"></script>
    <script src="./node_modules/highcharts/modules/export-data.js"></script>
    <script src="./node_modules/highcharts/modules/accessibility.js"></script>

    <!-- 그리드 -->
    <script src="./js/jsgrid.js"></script>

    <!-- pc로 excelFile export 할 때 쓰이는 API -->
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script> <!-- sheetjs -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.min.js"></script>

    <!-- 작성한 스크립트 -->
    <script src="./data/Data.js"></script>
    <script src="./data/func.js"></script>

    <!-- css -->
    <link rel="stylesheet" href="./node_modules/jstree/src/themes/default/style.css">
    <link rel="stylesheet" href="./css/jsgrid.css">
    <link rel="stylesheet" href="./css/jsgrid-theme.css">
    <link rel="stylesheet" href="./css/custom.css">

</head>

<body>
    <!-- 상단 메뉴 -->
    <div>
        <div class="pageChange" id="apiPage"
            onclick="window.location.href = `http://localhost:8080/task/homework/index.html`"> <!-- backtick(`) -->
            <span>API 사용한 페이지</span>
        </div><!--
        --><div class="pageChange" id="jqPage"
            onclick="window.location.href = `http://localhost:8080/task/practiceTable/table.html`">
            <span>JQUERY만 사용한 페이지</span>
        </div>
    </div>
    
    <div id="headerTitle"></div>
    <script>
        setPage(); // menu css 동적 제어
    </script>

    <!-------------- 본문 ---------------->
    <h3>자동차 브랜드 분류</h3>
    <!-- tree div -->
    <div id=tree></div>
    <input type="button" name="change" id="changeValue" value="적용" onclick="filterApplyButton();">

    <!-- chart div -->
    <figure class="highcharts-figure">
        <div id="container"></div>
    </figure>

    <!-- grid  div-->
    <div id="jsGrid"></div>

    <!-- export excel file -->
    <div id="exportDiv">
        <input type="button" value="excel export" id="exportButton" onclick="exportExcel();">
    </div>

    <!-- button, chart script (highcharts library works in the bodyTag only.) -->
    <script>
        var ctx = document.getElementById('container');

        function filterApplyButton() {
            setGridData();
            var chartData = setChartData();
            // ------------------- chart draw(action) ----------------------

            Highcharts.chart(ctx, {
                title: 
                {
                    text: '<b>월별 자동차 판매량</b> 및 <b style="color:#5062FF">아날로그 반도체 생산량</b>',
                    margin: 50
                },
                xAxis: 
                {
                    title: 
                    {
                        text: '월별',
                        style: {
                            fontWeight: 'bold',
                            fontSize: '15px'
                        }
                    },
                    categories: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
                    plotLines: [
                    {
                        /* 이벤트 발생 시 표시 할 라인입니다. */
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 3,
                        label: 
                        {
                            rotation: 0,
                            /* 라벨 회전 */
                            y: 45,
                            /* 라벨 위치 이동 */
                            style: 
                            {
                                fontSize: '10px'
                            },
                            text: '코로나로 공장 정지'
                        }
                    },
                    {
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 5,
                        label: 
                        {
                            y: 20,
                            style: 
                            {
                                fontSize: '10px'
                            },
                            text: '미국공장화재'
                        }
                    
                    },
                    {
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 6,
                        label: 
                        {
                            y: 5,
                            style:
                            {
                                fontSize: '10px'
                            },
                            text: '대만공장화재'
                        }
                    }
                    ]
                },
                yAxis: [
                {
                    min: 0,
                    labels: 
                    {
                        format: '{value}대'
                    },
                    title: 
                    {
                        text: '자동차판매량'
                    },
                    stackLabels: 
                    {
                        /* 항목별 데이터 총 합을 표시 */
                        enabled: true,
                        style: 
                        {
                            fontWeight: 'bold',
                            color: ( // theme
                                Highcharts.defaultOptions.title.style &&
                                Highcharts.defaultOptions.title.style.color
                            ) || 'gray'
                        }
                    }
                }, 
                {
                    min: 0,
                    labels: 
                    {
                        format: '{value}EA',
                        style: 
                        {
                            color: '#5062FF'
                        }
                    },
                    title: 
                    {
                        text: '아날로그 반도체 생산량',
                        style: 
                        {
                            color: '#5062FF'
                        }
                    },
                    opposite: false /* y축 반대쪽으로 둘건지 확인*/
                }],
                legend: 
                {
                    /* 항목별 설명 */
                    title: '항목별_정리',
                    align: 'left',
                    x: 100,
                    verticalAlign: 'top',
                    y: 30,
                    floating: true,
                    backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || 'white',
                    borderColor: '#CCC',
                    borderWidth: 1,
                    shadow: true
                },
                tooltip: 
                {
                    /* 그래프에 마우스오버 했을 때 나타나는 툴팁입니다. */
                    headerFormat: '<b>{point.x}</b><br />',
                    pointFormat: '{series.name}: {point.y}<br />Total: {point.stackTotal}'
                },
                plotOptions: 
                {
                    column: 
                    {
                        stacking: 'normal',
                        /* 한줄안에 묶여있게하는 옵션! */
                        dataLabels: 
                        {
                            enabled: false /* 그래프 위에 데이터 표시 지저분해서 안썼습니다. */
                        }
                    }
                },
                series: chartData
            });
        }
        // 최초 실행.
        setTimeout('filterApplyButton()',300);
    </script>

</body>

</html>