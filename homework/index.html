<!DOCTYPE html>
<html lang="ko">

<head>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아날로그 반도체 부족현상</title>
    <!-- 사용할 js 모듈들 -->
    <script src="./js/jquery-3.6.0.min.js"></script>
    <!-- 트리 -->
    <script src="./node_modules/jstree/src/jstree.js"></script>
    <script src="./node_modules/jstree/src/jstree.checkbox.js"></script>
    <script src="./data/treeData.js"></script>

    <!-- 차트 -->
    <script src="./node_modules/highcharts/highcharts.js"></script>
    <script src="./node_modules/highcharts/modules/series-label.js"></script>
    <script src="./node_modules/highcharts/modules/exporting.js"></script>
    <script src="./node_modules/highcharts/modules/export-data.js"></script>
    <script src="./node_modules/highcharts/modules/accessibility.js"></script>
    <script src="./data/chartData.js"></script>

    <!-- 그리드 -->
    <script src="./js/jsgrid.js"></script>

    <!-- css -->
    <link rel="stylesheet" href="./node_modules/jstree/src/themes/default/style.css">
    <link rel="stylesheet" href="./css/jsgrid.css">
    <link rel="stylesheet" href="./css/jsgrid-theme.css">
    <!-- 스타일 -->
    <style>
        .highcharts-figure {
            position: absolute;
            width: 65vw;
            right: 0;
        }
        #tree {
            border: 1px solid #000;
            position:absolute;
            width: 20%;
            height: 50vh;
            top: 50px;
        }
        h3{
            border: 1px solid #000;
            position: absolute;
            width:20%;
        }  
    </style>
</head>

<body>

    <h3>자동차 브랜드 분류</h3>
    <div id=tree>

    </div>
    <!-------------- Tree Script --------------->
    <script>

        $(function(){
            $('#tree').jstree({
                'core' : {
                    'themes' : {
                        'icons' : false /* jstree적용 시 리스트마다 생성되는 폴더 아이콘 삭제 */
                    },
                    'data' : treeData
                },
                'plugins' : [
                    'checkbox'
                ]
            });
        });
    </script>

    <!-- chart div -->
    <figure class="highcharts-figure">
        <div id="container"></div>
        <!-- <p class="highcharts-description">
      자동차에 들어가는 아날로그 반도체를 생산하는 업체가 코로나로 멈추고, 공장에 불이 나는 등 악재가 겹쳤습니다. <br>
      기존 반도체 회사들은 기존에 제공하던 IT반도체가 주 거래처이고 마진이 남지않는 아날로그 반도체를 굳이 만들지 않았습니다. <br>
      많은 자동차 회사들이 반도체 부족으로 차량생산에 차질이 생겼지만, 테슬라는 자체 반도체 생산기지를 가지고 있어 오히려 판매량이 늘었습니다.
    </p> -->
    </figure>

    <!-------------- Chart Script --------------->
    <script type="text/javascript">
        
        Highcharts.setOptions({
            colors: ['skyblue', 'gray', '#E70D00', 'skyblue', 'gray', '#E70D00', '#5062FF']
        })
        var ctx = document.getElementById('container');
        var totalChart = 
        Highcharts.chart(ctx, {
            chart: {
                type: 'column'
            },
            title: {
                text: '<b>월별 자동차 판매량</b> 및 <b style="color:#5062FF">아날로그 반도체 생산량</b>',
                margin: 50

            },
            xAxis: {
                title: {
                    text: '월별'
                },
                categories: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
                plotLines: [{
                        /* 이벤트 발생 시 표시 할 라인입니다. */
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 3,
                        label: {
                            rotation: 0,
                            /* 라벨 회전 */
                            y: 45,
                            /* 라벨 위치 이동 */
                            style: {
                                fontSize: '10px'
                            },
                            text: '코로나로 공장 정지'
                        }
                    },
                    {
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 5,
                        label: {
                            y: 20,
                            style: {
                                fontSize: '10px'
                            },
                            text: '미국공장화재'
                        }

                    },
                    {
                        color: 'red',
                        dashStyle: 'dot',
                        width: 1,
                        value: 6,
                        label: {
                            y: 5,
                            style: {
                                fontSize: '10px'
                            },
                            text: '대만공장화재'
                        }
                    }
                ]
            },
            yAxis: [{
                min: 0,
                labels: {
                    format: '{value}대'
                },
                title: {
                    text: '자동차판매량'
                },
                stackLabels: {
                    /* 항목별 데이터 총 합을 표시 */
                    enabled: true,
                    style: {
                        fontWeight: 'bold',
                        color: ( // theme
                            Highcharts.defaultOptions.title.style &&
                            Highcharts.defaultOptions.title.style.color
                        ) || 'gray'
                    }
                }
            }, {
                min: 0,
                labels: {
                    format: '{value}EA',
                    style: {
                        color: '#5062FF'
                    }
                },
                title: {
                    text: '아날로그 반도체 생산량',
                    style: {
                        color: '#5062FF'
                    }
                },
                opposite: false /* y축 반대쪽으로  둘건지 확인*/
            }],
            legend: {
                /* 막대그래프 툴팁? */
                title: '자동차회사',
                align: 'left',
                x: 100,
                verticalAlign: 'top',
                y: 30,
                floating: true,
                backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || 'white',
                borderColor: '#CCC',
                borderWidth: 1,
                shadow: true
            },
            tooltip: {
                /* 그래프에 마우스오버 했을 때 나타나는 툴팁입니다. */
                headerFormat: '<b>{point.x}</b><br/>',
                pointFormat: '{series.name}: {point.y}<br/>Total: {point.stackTotal}'
            },
            plotOptions: {
                column: {
                    stacking: 'normal',
                    /* 한줄안에 묶여있게하는 옵션! */
                    dataLabels: {
                        enabled: false /* 그래프 위에 데이터 표시 지저분해서 안썼습니다. */
                    }
                }
            },
            series: chartData
        });
    </script>

</body>

</html>