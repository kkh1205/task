<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swiper Grid</title>
    <!-- swiper, Toast ui grid 적용 -->
    <link rel="stylesheet" href="./node_modules/tui-grid/dist/tui-grid.min.css">
    <link rel="stylesheet" href="./node_modules/swiper/swiper-bundle.css">
    <link rel="stylesheet" href="./node_modules/tui-pagination/dist/tui-pagination.css">
    <script src="./node_modules/swiper/swiper-bundle.js"></script>
    <!-- pagination이 tui-grid보다 먼저 선언되어야 한다. -->
    <script src="./node_modules/tui-pagination/dist/tui-pagination.js"></script>
    <script src="./node_modules/tui-grid/dist/tui-grid.min.js"></script>

    <style>
        .tui-grid-cell-header {
            font-size: larger;
        }

        .tui-grid-cell-has-input {
            font-size: medium;

            text-align: center !important
        }

        h3 {
            text-align: center;
            background-color: rgba(81, 92, 230, 0.1);
        }
        
        #grid {
            width: 800px;
            margin: auto;
            margin-top: 5%;
        }
    </style>
</head>

<body>
    <div class="swiper-container">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <h3>예제 테이블</h3>
                <div id="grid"></div>
            </div>
            <div class="swiper-slide">
                <h3>2021 레이싱 게임 분기별 판매 현황</h3>
                <div style="margin: 5%;" id="cColumn">
                <div class="btn-wrapper">
                    <button style="margin-bottom: 1%;" id="appendBtn">데이터 추가</button>
                    <button style="margin-bottom: 1%;" id="prependBtn">앞에 데이터 추가</button>
                </div>
                </div>
            </div>
            <div class="swiper-slide">
                <h3>예제 테이블 3</h3>
                <div style="margin: 5%;" id="exampleGrid3"></div>
            </div>
        </div>
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
    </div>

    <script>
        // ---------- 예제1 tui grid -------------
        var gridData = [{
                // 데이터 생성 시 Row단위로 생성
                tests: 'test1',
                A: 8.2,
                B: 5.3,
                C: 6.5
            },
            {
                tests: 'test2',
                A: 4.2,
                B: 3.9,
                C: 5.3
            },
            {
                tests: 'test3',
                A: 2.2,
                B: 1.5,
                C: 3.2
            },
            {
                tests: 'test4',
                A: 1.2,
                B: 2.1,
                C: 12
            }
        ]

        // draw grid
        const grid = new tui.Grid({
            el: document.getElementById('grid'),
            data: gridData,
            // header 설정
            header: {
                // header height
                height: 35
            },
            // rowHeader로 번호나 체크박스 쉽게 달수있다.
            rowHeaders: ['rowNum','checkbox'],
            // column 전체에 옵션을 먹임(우선순위가 높다)
            columnOptions: {
                minWidth: 120, // minWidth로 width옵션의 최소값을 지정할 수 있다.(테이블 기본값 보다 작게 설정 가능)
            },
            // row height를 지정.
            //  minRowHeight를 사용하면 rowHeight를 기존 값 보다 더 작게 설정 할 수 있다.
            minRowHeight: 10,
            // row height를 지정.
            rowHeight: 20,
            // bodyHeight의 최소값은 130이다. minBodyHeight를 설정하면 최소값을 더 작게 설정 할 수 있다.
            minBodyHeight: 100,
            columns: [{
                    header: 'Test별', // display 되는 값
                    name: 'tests', // 해당 컬럼 이름.
                    // renderer의 defalut 값 중 styles. css 값을 적용 시킬 수 있다.
                    renderer: {
                        styles: {
                            fontWeight: 'bold',
                            color: (props) => props.value === 'test1' ? 'red' : props.value === 'test2' ? 'blue' : props.value === 'test3' ? 'green' : props.value === 'test4' ? 'yellow' : 'black'
                        }
                    },
                    // width 값을 줄 수 있다.(픽셀단위) minWidth보다 작아질 수 없다.
                    width: '100'
                },
                {
                    header: 'A기체',
                    name: 'A',
                    // 최소값, 최대값을 넘으면 background color 변경
                    validation: {
                        min: 1.5,
                        max: 6
                    },
                    // renderer의 defalut 값 중 classNames. 컬럼의 class를 정의 할 수 있다.
                    renderer: {
                        classNames: ['test-Value']
                    }
                },
                {
                    header: 'B기체',
                    name: 'B',
                    validation: {
                        min: 1.5,
                        max: 6
                    },
                    // renderer의 defalut 값 중 classNames. 컬럼의 class를 정의 할 수 있다.
                        renderer: {
                        classNames: ['test-Value']
                    }
                },
                {
                    header: 'C기체',
                    name: 'C',
                    validation: {
                        min: 1.5,
                        max: 6
                    },
                    // renderer의 defalut 값 중 classNames. 컬럼의 class를 정의 할 수 있다.
                        renderer: {
                        classNames: ['test-Value']
                    }
                },
            ]
        });


        // ---------- 예제2 복합 컬럼 tui grid -------------
        // complexColumns data
        var dataSet = {
            DrivingGame: [{
                    'game': 'Forza Horizon 5 (xboxGamePass제외)',
                    '1q': 1300,
                    '2q': 2000,
                    '3q': 1490,
                    '4q': 800,
                    'selectCell': '1',
                    'checkboxCell': ['1', '2', '3'],
                    'radioboxCell': '5'
                },
                {
                    'game': 'The Crew2',
                    '1q': 800,
                    '2q': 700,
                    '3q': 650,
                    '4q': 630,
                    'selectCell': '1',
                    'checkboxCell': '1',
                    'radioboxCell': '4'
                },
                {
                    'game': 'Need for speed Heat',
                    '1q': 850,
                    '2q': 870,
                    '3q': 670,
                    '4q': 400,
                    'selectCell': '3',
                    'checkboxCell': '1',
                    'radioboxCell': '2'
                },
                {
                    'game': 'Asseto Corsa',
                    '1q': 450,
                    '2q': 700,
                    '3q': 1000,
                    '4q': 1200,
                    'selectCell': '1',
                    'checkboxCell': '2',
                    'radioboxCell': '4'
                },
                {
                    'game': 'Project Cars2',
                    '1q': 1100,
                    '2q': 700,
                    '3q': 630,
                    '4q': 420,
                    'selectCell': '1',
                    'checkboxCell': '2',
                    'radioboxCell': '3'
                },
                {
                    'game': 'Dirt5',
                    '1q': 670,
                    '2q': 400,
                    '3q': 340,
                    '4q': 250,
                    'selectCell': '2',
                    'checkboxCell': ['3', '2'],
                    'radioboxCell': '1'
                }
            ]
        }

        // draw grid 
        const complexColumns = new tui.Grid({
            el: document.getElementById('cColumn'), // 표가 생성 될 div
            data: dataSet.DrivingGame,
            rowHeaders: ['rowNum'],
            // page 넣는 옵션.
            pageOptions: {
                useClient: true, // 백엔드와 연동 없이 돌릴 시 적용 시켜야 하는 옵션
                perPage: 8  // row가 한 페이지에 8까지 표시됨.
            },

            // 뷰포트 영역 높이 고정. 전체 행 높이가 더 큰 경우 Y축에 스크롤이 생성된다.
            bodyHeight: 250,

            // 하위 컬럼.
            columns: [{
                    header: 'Games(클릭 시 이동)',
                    name: 'game',
                    // 필터링 옵션. text, number, select, date 총 4가지 빌트인 필터를 제공
                    filter: {
                        type: 'text',
                        operator: 'OR', // 필터링 조건 OR, AND
                        // 적용, 클리어 버튼
                        showApplyBtn: true,
                        showClearBtn: true
                    },
                },
                {
                    header: '1분기(내림차순)',
                    name: '1q',
                    sortable: true
                },
                {
                    header: '2분기',
                    name: '2q',
                    sortable: true
                },
                {
                    header: '3분기',
                    name: '3q',
                    sortable: true
                },
                {
                    header: '4분기',
                    name: '4q',
                    sortable: true,
                    sortingType: 'desc' // 오름차순, 내림차순 --> default값 asc(오름차순)
                },
                {
                    header: 'DLC유무',
                    name: 'selectCell',
                    // 값을 인자로 가져와서 함수로 필터링 가능함.
                    validation: {
                        validatorFn: value => value !== '3'
                    },
                    formatter: 'listItemText',
                    editor: {
                        type: 'select', // select는 적용버튼 클리어 버튼 적용 안됨.
                        options: {
                            listItems: [{
                                    text: '유',
                                    value: '1',
                                },
                                {
                                    text: '무',
                                    value: '2',
                                },
                                {
                                    text: '차후 추가 예정',
                                    value: '3'
                                }
                            ]
                        }
                    }
                },
                {
                    header: '레이싱 장르',
                    name: 'checkboxCell',
                    filter: {
                        type: 'text',
                        operator: 'OR',
                        showApplyBtn: true,
                        showClearBtn: true
                    },
                    formatter: 'listItemText',
                    editor: {
                        type: 'checkbox',
                        options: {
                            listItems: [{
                                    text: '오픈월드 레이싱',
                                    value: '1',
                                },
                                {
                                    text: '심레이싱',
                                    value: '2',
                                },
                                {
                                    text: '오프로드 레이싱',
                                    value: '3'
                                }
                            ]
                        }
                    }
                },
                {
                    header: '평점',
                    name: 'radioboxCell',
                    filter: 'select',
                    copyOptions: {
                        useListItemText: true,
                    },
                    formatter: 'listItemText',
                    editor: {
                        type: 'radio',
                        options: {
                            listItems: [{
                                    text: '★☆☆☆☆',
                                    value: '1'
                                },
                                {
                                    text: '★★☆☆☆',
                                    value: '2'
                                },
                                {
                                    text: '★★★☆☆',
                                    value: '3'
                                },
                                {
                                    text: '★★★★☆',
                                    value: '4'
                                },
                                {
                                    text: '★★★★★',
                                    value: '5'
                                },

                            ]
                        }
                    },
                }
            ],
            // header.complexColumns로 복합컬럼 정의. 트리구조로 만들 수 있다.
            header: {
                height: 100,
                complexColumns: [{
                        header: '상반기',
                        name: 'firstHalf',
                        childNames: ['1q', '2q'] // 하위컬럼 지정.
                    },
                    {
                        header: '하반기',
                        name: 'secondHalf',
                        childNames: ['3q', '4q']
                    },
                    {
                        header: '2021',
                        name: 'year',
                        childNames: ['firstHalf', 'secondHalf']
                    }
                ]
            },
        });

        const appendBtn = document.getElementById('appendBtn');
        const prependBtn = document.getElementById('prependBtn');

        const appendedData = {
            game: 'game',
            '1q': '1분기 데이터',
            '2q': '2분기 데이터',
            '3q': '3분기 데이터',
            '4q': '4분기 데이터',
            selectCell: '1',
            checkboxCell: '1',
            radioboxCell: '1'
        };

        appendBtn.addEventListener('click', () => {
            complexColumns.appendRow(appendedData);
        });

        prependBtn.addEventListener('click', () => {
            complexColumns.prependRow(appendedData);
        });

        // ######## 셀 클릭 시 링크 띄우기 #########
        complexColumns.on('click', (ev) => {
            // 링크 주소 모음
            var links = [
                'https://namu.wiki/w/%ED%8F%AC%EB%A5%B4%EC%9E%90%20%ED%98%B8%EB%9D%BC%EC%9D%B4%EC%A6%8C%205',
                'https://namu.wiki/w/%EB%8D%94%20%ED%81%AC%EB%A3%A8%202?from=%EB%8D%94%ED%81%AC%EB%A3%A82',
                'https://namu.wiki/w/%EB%8B%88%EB%93%9C%20%ED%8F%AC%20%EC%8A%A4%ED%94%BC%EB%93%9C:%20%ED%9E%88%ED%8A%B8?from=%EB%8B%88%EB%93%9C%ED%8F%AC%EC%8A%A4%ED%94%BC%EB%93%9C%20%ED%9E%88%ED%8A%B8',
                'https://namu.wiki/w/%EC%95%84%EC%84%B8%ED%86%A0%20%EC%BD%94%EB%A5%B4%EC%82%AC',
                'https://namu.wiki/w/Project%20CARS%202',
                'https://namu.wiki/w/DiRT%205'
            ];
            
            // 셀 클릭 시 몇번째 row에 column이름이 game인 셀이면 link를 띄운다.
            for(var i =0; i<links.length; i++) {
                if(ev.rowKey === i && ev.columnName === 'game'){
                    window.open(links[i]);
                }
            }
        });

        // ------------ 예제3 rowSpan, 비활성화 예제 ------------
        const gridData3 = [{
                name: 'Beautiful Lies',
                artist: 'Birdy',
                release: '2016.03.26',
                type: 'Deluxe',
                genre: 'Pop'
            },
            {
                name: 'X',
                artist: 'Ed Sheeran',
                release: '2014.06.24',
                type: 'Deluxe',
                genre: 'Pop',
                _attributes: {
                    disabled: true // row 비활성화
                }
            },
            {
                name: 'Moves Like Jagger',
                release: '2011.08.08',
                artist: 'Maroon5',
                type: 'Single',
                genre: 'Pop,Rock',
                _attributes: {
                    checkDisabled: true // checkbox 비활성화
                }
            },
            {
                name: 'A Head Full Of Dreams',
                artist: 'Coldplay',
                release: '2015.12.04',
                type: 'Deluxe',
                genre: 'Rock',
                _attributes: {
                    checked: true, // 체크박스 체크
                    /* // background-color관련 기능 작동안함
                    classNames: {
                        // Add class name on a row
                        row: ['red']
                    } */
                }
            },
            {
                name: 19,
                artist: 'Adele',
                release: '2008.01.27',
                genre: 'Pop,R&B',
                _attributes: {
                    rowSpan: {
                        // rowSpan 밑에 뭘 적든 이 데이터에 적힌 값으로 marge된다.
                        artist: 3,
                        genre: 2
                    }
                }
            },
            {
                name: 21,
                artist: 'rowSpan되서 안보임',
                release: '2011.01.21',
                type: 'Deluxe',
                genre: 'rowSpan되서 안보임'
            },
            {
                name: 25,
                artist: 'rowSpan되서 안보임',
                release: '2015.11.20',
                type: 'EP',
                genre: 'Pop'
            }
        ];
        

        // ---------- exampleGrid 3 draw -----------
        const exampleGrid3 = new tui.Grid({
            el: document.getElementById('exampleGrid3'),
            data: gridData3,
            scrollX: false,
            scrollY: false,
            // rowHeader로 번호나 체크박스를 지정해줄 수 있다.
            // rowHeaders: ['rowNum','checkbox'] 이렇게 넣으면 기본값으로 쉽게 들어간다.
            // 추가 옵션을 적용 시킬 시
            rowHeaders: [{
                    type: 'rowNum',
                    width: 50,
                    align: 'center',
                    valign: 'middle'
                },
                {
                    type: 'checkbox'
                }
            ],
            columns: [{
                    header: 'Name',
                    name: 'name',
                    // data 타입이 sting이 아닐 시 background-color가 red로 설정됨.
                    validation: {
                        dataType: 'string'
                    }
                },
                {
                    header: 'Artist',
                    name: 'artist'
                },
                {
                    header: 'Type',
                    name: 'type',
                    // data가 존재하지 않으면 background-color가 red로 설정됨.
                    // 존재 할 땐 yellow로 설정됨.
                    validation: {
                        required: true
                    }
                },
                {
                    header: 'Release',
                    name: 'release'
                },
                {
                    header: 'Genre',
                    name: 'genre'
                },
                {
                    header: 'linkButton',
                    name: 'linkBt'
                }
            ]
        });

        // checkbox 로 이벤트 받을 때.
        // 첫번째 인자는 타겟이벤트 이름.
        // 두번째 인자는 등록할 핸들러.
        exampleGrid3.on('check', (ev) => {
            alert(`check: ${ev.rowKey}`);
        });

        exampleGrid3.on('uncheck', (ev) => {
            alert(`uncheck: ${ev.rowKey}`);
        });
        

        // ---------- swiper 적용 -------------
        var swiper = new Swiper('.swiper-container', {
            // 좌우 버튼
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev'
            },
            allowTouchMove: false // 터치 무브 금지. 이거 안걸면 grid기능 사용 안됩니다.
        });
    </script>
</body>

</html>